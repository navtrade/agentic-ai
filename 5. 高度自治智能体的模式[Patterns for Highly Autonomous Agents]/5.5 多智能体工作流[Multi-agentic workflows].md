## 多代理系统（ **Multi-agentic workflows** ）

尽管所有Agent可能都基于同一个底层 LLM ，并运行在同一台电脑上，但将复杂任务**分解**成多个**独立的角色**或**进程**是一种更有效的开发方法，就像团队协作或计算机的多线程/多进程一样。

想想看，你现在有一个十分复杂的AI业务系统，LLM需要调用十几种甚至几十种工具，并在一段几千字的提示词的指导下运行。一个典型的业务流程都需要七八步才能实现。

在这种情况下，把一个Agent拆成很多次级Agent，并构成一个多Agent系统，即MultiAgent系统，就十分有必要了。多个承担不同任务的Agent可以靠互相协作来解决复杂的任务，提高系统的效率和模块化。

---

下图就是一个拆分市场Agent的例子，拆出了调研、生成报表、创建文件三个子Agent

![](..\images\5.5.1.png)

![](..\images\5.5.2.png)

MultiAgent系统具有以下优势：

* 任务分解： 像人类团队一样，将复杂任务自然地分解为拥有不同角色和技能的子任务。
* 专注性： 允许开发者一次专注于构建一个特定角色，就像只需专注于构建最好的“平面设计师代理”。通常，单个Agent的任务越简单，任务完成的效果就越好。
* 模块化与复用： 有机会创建可复用于其他应用的通用代理，就像一个通用的“平面设计师代理”可以用于营销手册和社交媒体帖子。

> 此外，笔者还认为MultiAgnet系统有以下两个优势：
>
> * 突破上下文限制。现在绝大多数模型都具有128k的上下文，对于一些需要多轮规划执行的调研类任务或业务分析任务来说是完全不够的。但如果让每个Agent只负责自己的部分，最终只返回自己部分的调研结果，让一个总结Agent总结各个子Agent的调研结果，生成最终报告，就能规避上下文的限制，因为总结Agent不必在上下文中存储其它Agent的调研过程，它只看结果就够了。
> * 节约成本。在资金成本上，每次请求都附带大量上下文是非常烧钱的，即使命中缓存。MultiAgent体系中每个Agent上下文都比较短，更节约Tokens费用；在时间成本上，上下文越短，LLM回复速度越快，延迟越低，同时多个Agent还能并行处理任务，可以将时间成本大大降低。

通常，我们通过提示词+工具的组合来创建不同的Agent。比如对于一个市场分析Agent，就需要告诉LLM它具有高超的市场分析技巧，和他讲一些市场分析的范式与最佳实践，并给它配备网页浏览工具，以便它可以自己去做市场调研。

接下来，我们会深入探讨**代理之间通信模式**的设计，介绍一些最常见的模式，了解如何让多个代理有效地相互协作。

